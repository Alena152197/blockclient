# Быстрая настройка Strapi для автоматической установки автора

## Проблема
При создании поста через API поле `author` не устанавливается автоматически, и его нельзя установить через PUT/PATCH запрос из-за ограничений прав доступа в Strapi.

## Решение: Lifecycle Hook (Самый простой способ)

### Шаг 1: Найдите папку с моделью Post на сервере Strapi

На сервере, где установлен Strapi, найдите папку:
```
src/api/post/content-types/post/
```

### Шаг 2: Создайте файл lifecycles.js

Создайте файл `lifecycles.js` в этой папке:
```
src/api/post/content-types/post/lifecycles.js
```

### Шаг 3: Скопируйте код

Скопируйте код из файла `STRAPI_LIFECYCLE_EXAMPLE.js` в созданный файл `lifecycles.js`

Или вставьте этот код напрямую:

```javascript
'use strict';

module.exports = {
  async beforeCreate(event) {
    const { data } = event.params;
    const user = event.state.user;
    
    // Автоматически устанавливаем автора из токена
    if (user && !data.author) {
      data.author = user.id;
      console.log(`Автоматически установлен автор для поста: ${user.id} (${user.username})`);
    }
  },
};
```

### Шаг 4: Перезапустите Strapi

После создания файла перезапустите сервер Strapi:
```bash
npm run develop
# или
npm run start
```

### Шаг 5: Проверьте работу

1. Создайте пост через консоль в вашем приложении
2. Проверьте логи Strapi - должно появиться сообщение об установке автора
3. Проверьте, что пост появился в "Мои интересы"

## Альтернатива: Настройка через админ-панель

Если у вас нет доступа к файлам на сервере:

### Шаг 1: Откройте админ-панель Strapi
`https://324cbb377ef9.vps.myjino.ru/admin`

### Шаг 2: Настройте права доступа
1. Settings → Users & Permissions Plugin → Roles → Authenticated
2. Найдите модель **Post**
3. Включите права:
   - ✅ create
   - ✅ update
   - ✅ find
   - ✅ findOne

### Шаг 3: Проверьте Content-Type Builder
1. Content-Type Builder → Post → author
2. Убедитесь, что поле не помечено как "Private" или "Read-only"
3. Тип связи: **Relation** → **User** (Many-to-One)

**Важно:** Этот способ может не сработать, если поле `author` специально защищено от редактирования через API. В таком случае обязательно используйте Lifecycle Hook.

## После настройки

После применения Lifecycle Hook:
- ✅ Посты будут автоматически получать автора из токена
- ✅ Не нужно будет устанавливать автора вручную
- ✅ Посты сразу будут появляться в "Мои интересы"

## Диагностика

Если после настройки автор все еще не устанавливается:

1. Проверьте логи Strapi на наличие ошибок
2. Убедитесь, что файл `lifecycles.js` создан в правильной папке
3. Убедитесь, что Strapi перезапущен после создания файла
4. Проверьте, что пользователь авторизован (токен передается в запросе)

